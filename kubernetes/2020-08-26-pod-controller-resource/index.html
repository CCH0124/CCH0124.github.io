<!doctype html><html lang=en-us style=max-width:1000px;margin:auto><head><title>Kevin Blog</title><meta name=theme-color content><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta name=description content="Kevin learning"><meta name=author content="Kevin Chen"><meta name=generator content="aafu theme by Darshan in Hugo 0.83.0"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.2/css/all.css integrity=sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu crossorigin=anonymous><link rel=stylesheet href=https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Didact+Gothic%7CRoboto:400%7CRoboto+Mono"><link rel=stylesheet href=/css/aafu_pinkish.css><link rel=stylesheet href=/css/aafu.css><script>var themeColor=document.querySelector("meta[name=theme-color]");window.onload=()=>{themeColor.content=getComputedStyle(document.body)["background-color"];let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")},window.onresize=()=>{let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")}</script></head><body class=container><main style="min-height:calc(100vh - 60px)"><div class="d-flex flex-row row p-2"><h3 class="main-menu mr-3"><a href=https://cch0124.github.io/>Home</a></h3><h3 class="main-menu mr-3"><a href=/blog>Blog</a></h3><h3 class="main-menu mr-3"><a href=/project>Project</a></h3><h3 class="main-menu mr-3"><a href=/life>Life</a></h3><h3 class="main-menu mr-3"><a href=/kubernetes>Kubernetes</a></h3><h3 class="main-menu mr-3"><a href=/code>Coding</a></h3></div><div class=mb-3><h1 class=top-h1 style=font-size:2.75em>kubernetes - day05</h1><p class=mb-1>August 26, 2020</p><p>&mdash;</p></div><div class=content><p>上一篇文章，教大家操作 Kubernetes 群集相關的操作，之前也大致說明 POD 是什麼。今天這篇文章會介紹到與 POD 相關的 POD 控制器和一些資源應用，這為了能夠更加豐富的運用 POD 資源，進而將容器的應用變得更加靈活、完善和操作等。下圖顯示了 Kubernetes POD 如何被 Kubernetes 的更抽象資源去應用。</p><figure><img src=/images/k8s/K8s-day05.jpg width=auto height=auto></figure><p>在前面文章有介紹過 <code>POD</code>，它負責運行<em>容器</em>，同時解決環境依賴的一些問題，可能會是共享的儲存、配置資訊或網頁伺服器要的 SSL 等。然而 <code>POD</code> 的運行過程中可能會遇到一些資源配置不足或是一些突發狀況導致 <code>POD</code> 非正常的終止。這問題 <code>Kubernetes</code> 由<em>負載類型</em>的 <code>POD</code> 控制器去負責，適當將故障的 <code>POD</code> 重建。</p><p>雖然 <code>POD</code> 控制器能夠重建資源，但有些應用程序是有順序的概念，因此這邊又可將 <code>POD</code> 控制器分類為<strong>無狀態</strong>和<strong>有狀態</strong>類型。圖中 <code>ReplicaSet</code> 和 <code>Deployment</code> 屬於管理無狀態類型服務，<code>StatefulSet</code> 則是有狀態。除了這些， Kubernetes 還提供一些特殊應用的服務，像是 <code>DaemonSet</code> 它用於為每個節點上運行單一個 <code>POD</code> 的資源，可能是 Log 蒐集或是監控服務等應用，還有 <code>Job</code> 控制器，它可以提供短暫批次任務，完成後即可終止該資源。</p><p>POD 資源一般來說是群集內可相互存取的，再次重建後也應該要被<em>發現</em>。如果 POD 要給外部使用者存取則需要透過暴露方式，並且要有負載均衡。在 Kubernetes 中透過 <code>Service</code> 和 <code>Endpoint</code> 與 <code>Ingress</code> 可以解決發現、服務暴露和附載均衡。</p><p>在 Kubernetes 中設計了 <code>Volume</code>，可用於幫助 <code>POD</code> 的資源儲存，它支援了儲存設備和系統，像是 <code>GlusterFS</code>、<code>CEPH RBD</code> 和 <code>NFS</code> 等。不過 Kubernetes 有抽象了 <code>CSI（Container Storage Interface）</code> 統一儲存介面以便擴展更多的儲存應用。容器在運行時將不同環境所需的變數用<em>環境變數</em>作為解決方案，但容器啟動後不得更改。在 Kubernetes 中 <code>configMap</code> 能夠以<em>環境變數</em>或<em>volume</em>方式傳入至 POD 的容器中，它同時可被不同應用的 POD 共享，使得靈活性提高，然而對於此方式較隱密的資訊較不適合 <code>configMap</code> 需使用 <code>Secret</code>。</p><p>透過上面的描述，我們將與 <code>POD</code> 相關的資源進行一系列的詳細說明。但是 Kubernetes 卻沒有那麼簡單，還有許多應用需要去學習，像是 <code>HorizontalPodAutoscaler</code> 自動伸縮工作負載；<code>LimitRange</code> 可以對硬體資源請求做限制等。預計下一篇會開始操作 <code>POD</code> 資源。</p><h2 id=參考資源>參考資源</h2><ul><li>Kubernetes in action</li><li><a href=https://kubernetes.io/docs/concepts/workloads/pods/>官方 POD</a></li></ul></div><div class="d-flex flex-row justify-content-around"><h3 class="mb-1 mt-1 text-left mr-4"><a href=/kubernetes/2020-08-25-k8s-bubectl-basic-operation/ title="kubernetes - day04"><i class="nav-menu fas fa-chevron-circle-left"></i></a></h3><h3 class="mb-1 mt-1 text-left ml-4"><a href=/kubernetes/2020-08-27-resource-format/ title="kubernetes - day06"><i class="nav-menu fas fa-chevron-circle-right"></i></a></h3></div></main><footer class="mt-2 mb-4 text-center"><span class=markdownify>short copyright message</span>
<span>&#183;
<i><a href=https://github.com/darshanbaral/aafu>aafu</a></i>
by
<a href=https://www.darshanbaral.com/>darshan</a></span></footer></body></html>