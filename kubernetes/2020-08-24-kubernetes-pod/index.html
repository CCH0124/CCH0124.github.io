<!doctype html><html lang=en-us style=max-width:1000px;margin:auto><head><title>Kevin Blog</title><meta name=theme-color content><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta name=description content="Kevin learning"><meta name=author content="Kevin Chen"><meta name=generator content="aafu theme by Darshan in Hugo 0.83.0"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.2/css/all.css integrity=sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu crossorigin=anonymous><link rel=stylesheet href=https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Didact+Gothic%7CRoboto:400%7CRoboto+Mono"><link rel=stylesheet href=/css/aafu_pinkish.css><link rel=stylesheet href=/css/aafu.css><script>var themeColor=document.querySelector("meta[name=theme-color]");window.onload=()=>{themeColor.content=getComputedStyle(document.body)["background-color"];let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")},window.onresize=()=>{let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")}</script></head><body class=container><main style="min-height:calc(100vh - 60px)"><div class="d-flex flex-row row p-2"><h3 class="main-menu mr-3"><a href=https://cch0124.github.io/>Home</a></h3><h3 class="main-menu mr-3"><a href=/blog>Blog</a></h3><h3 class="main-menu mr-3"><a href=/project>Project</a></h3><h3 class="main-menu mr-3"><a href=/life>Life</a></h3><h3 class="main-menu mr-3"><a href=/kubernetes>Kubernetes</a></h3><h3 class="main-menu mr-3"><a href=/code>Coding</a></h3></div><div class=mb-3><h1 class=top-h1 style=font-size:2.75em>kubernetes - day03</h1><p class=mb-1>August 24, 2020</p><p>&mdash;</p></div><div class=content><h1 id=kubernetes-核心資源-pod-介紹>Kubernetes 核心資源 POD 介紹</h1><p>在集群的 <code>Master</code> 上提供了 <code>API Server</code> 元件，同時有著 <code>RESTful</code> 的風格。像是 POD 資源包含了所有 POD 對象的集合，其用於描述在哪個節點進行容器的實例、需要配置什麼樣的環境(硬體資源或儲存)和管理上的策略，其策略可能是<em>重啟</em>、<em>升級</em>等。另外的 Kubernetes 也提供比 POD 更抽象的 POD 控制器，可用來確保 POD 的存在，這些控制器有 <em>Deployment</em>、<em>Service</em> 等。</p><h2 id=pod-資源對象>POD 資源對象</h2><p>POD 是一到多個容器應用的集合，這也包含著儲存、網路等元件。POD 可以想成是一個應用程式運行的實例，當中共享著前面提到的原件，如下圖所示。</p><figure><img src=/images/k8s/K8s-POD.jpg width=auto height=auto></figure><p>因為共享著網路，所以 POD 中的對象都會是同一網段。因此可以透過 IP 直接進行通訊，不論是在哪一個節點上。所以這樣的結構可以想像成是一個 VM 虛擬機，但不同的是 POD 中的對象容器各個行程都相互彼此隔離。整體來看，該 POD 中的網路與儲存是容器的關鍵資源。但是，與 POD 外部的元件通訊需要透過 <code>service</code> 資源所創建的 <code>ClusterIP</code> 等類型和對應 <code>Port</code> 進行通訊。為了讓 POD 中資源能夠共享數據，因此提供了 <code>volume</code> 的資源。在更高階的抽象中該 <code>volume</code> 還可以讓容器在生命週期中時確保數據不遺失。</p><p>之後的章節會分享對於 POD 的擴充機制、訊息的處裡等資源。</p><p>圖中我們還看到一個為 <code>Pause</code> 的容器，該容器是 POD 中的基礎設施。它的 <code>image</code> 很小，都處於暫停狀態，它是解決 POD 網路而產生的，所以 POD 的 Network Namespace 的對應就是該容器。其實現程式碼從此<a href=https://github.com/kubernetes/kubernetes/tree/master/build/pause>鏈接</a>可以得知如何實現。</p><h2 id=pod-控制器>POD 控制器</h2><p>不只有容器有生命週期，POD 本身也有生命週期，當透過 <code>Master</code> 中控制器建立 POD 資源時會被 <code>Scheduler</code> 調度到節點，並由 <code>kubelet</code> 建立容器，然而容器的執行任務結束後，會被正常程序給終止並刪除。</p><p>當中的 POD 資源假設某種原因故障進而終止程序並刪除，這對於維運者來說會是一個挑戰。因此 Kubernetes 提供了 POD 控制器來進行一些高階的操作，像是實現固定數量、POD 的擴縮容機制、滾動式的更新等，這些操作會自動的做調度處裡，以解決節點故障問題等。</p></div><div class="d-flex flex-row justify-content-around"><h3 class="mb-1 mt-1 text-left mr-4"><a href=/kubernetes/2020-08-20-kubernetes-install/ title="kubernetes 1.18 安裝-day 02"><i class="nav-menu fas fa-chevron-circle-left"></i></a></h3><h3 class="mb-1 mt-1 text-left ml-4"><a href=/kubernetes/2020-08-25-k8s-bubectl-basic-operation/ title="kubernetes - day04"><i class="nav-menu fas fa-chevron-circle-right"></i></a></h3></div></main><footer class="mt-2 mb-4 text-center"><span class=markdownify>short copyright message</span>
<span>&#183;
<i><a href=https://github.com/darshanbaral/aafu>aafu</a></i>
by
<a href=https://www.darshanbaral.com/>darshan</a></span></footer></body></html>