<!doctype html><html lang=en-us style=max-width:1000px;margin:auto><head><title>Kevin Blog</title><meta name=theme-color content><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta name=description content="Kevin learning"><meta name=author content="Kevin Chen"><meta name=generator content="aafu theme by Darshan in Hugo 0.83.0"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.2/css/all.css integrity=sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu crossorigin=anonymous><link rel=stylesheet href=https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Didact+Gothic%7CRoboto:400%7CRoboto+Mono"><link rel=stylesheet href=/css/aafu_pinkish.css><link rel=stylesheet href=/css/aafu.css><script>var themeColor=document.querySelector("meta[name=theme-color]");window.onload=()=>{themeColor.content=getComputedStyle(document.body)["background-color"];let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")},window.onresize=()=>{let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")}</script></head><body class=container><main style="min-height:calc(100vh - 60px)"><div class="d-flex flex-row row p-2"><h3 class="main-menu mr-3"><a href=https://cch0124.github.io/>Home</a></h3><h3 class="main-menu mr-3"><a href=/blog>Blog</a></h3><h3 class="main-menu mr-3"><a href=/project>Project</a></h3><h3 class="main-menu mr-3"><a href=/life>Life</a></h3><h3 class="main-menu mr-3"><a href=/kubernetes>Kubernetes</a></h3><h3 class="main-menu mr-3"><a href=/code>Coding</a></h3></div><div class=mb-3><h1 class=top-h1 style=font-size:2.75em>wireshark analysis Ann Skips Bail</h1><p class=mb-1>May 18, 2020</p><p>&mdash;</p></div><div class=content><p><a href=http://forensicscontest.com/2009/10/10/puzzle-2-ann-skips-bail>內容</a></p><h2 id=題目>題目</h2><ol><li>What is Ann’s email address?</li><li>What is Ann’s email password?</li><li>What is Ann’s secret lover’s email address?</li><li>What two items did Ann tell her secret lover to bring?</li><li>What is the NAME of the attachment Ann sent to her secret lover?</li><li>What is the MD5sum of the attachment Ann sent to her secret lover?</li><li>In what CITY and COUNTRY is their rendez-vous point?</li><li>What is the MD5sum of the image embedded in the document?</li></ol><h3 id=1-what-is-anns-email-address>1. What is Ann’s email address?</h3><p>通常 mail 傳輸會使用 <code>SMTP</code> 協定，為了確定可透過 <code>statistics -> protocol Hierarchy</code> 查看該 pcap 流量的協定統計。</p><p><img src=https://i.imgur.com/NugJbAg.png alt></p><p>藉由 <code>smtp.auth.username</code> 的 filter 可得到經過編碼的 username <code>c25lYWt5ZzMza0Bhb2wuY29t</code> 經過解碼為 <code>sneakyg33k@aol.com</code>。</p><h3 id=2-what-is-anns-email-password>2. What is Ann’s email password?</h3><p>透過 <code>smtp.auth.password</code> filter 即可知道，並經過解碼後得到 <code>558r00lz</code></p><p>我們知道應用層的資訊會透過 socket 寫進傳輸層的緩存並將它封裝成 segment，在透過網路層傳輸至另一個端點。因此題目 1 與 2 從 <code>TCP Stream</code> 也可以去解析。藉由 <code>ip.addr == 192.168.1.159 && tcp</code> 進行過濾，查看過濾後第一個封包的 <code>TCP Stream</code> 如下圖</p><p><img src=https://i.imgur.com/7bzhQeX.png alt></p><h3 id=3-what-is-anns-secret-lovers-email-address>3. What is Ann’s secret lover’s email address?</h3><p>得先知道這所有封包中 Ann 寄過的人使用 <code>smtp.req.parameter contains "TO"</code> 方式或 <code>smtp.req.command contains "RCPT"</code> 過濾都可以看到，其 72 與 132 封包的收件人分別是 <code>sec558@gmail.com</code> 和<code>mistersecretx@aol.com</code>。</p><p>查看封包後 <code>mistersecretx@aol.com</code> 應該是答案。因為內容有這樣的內容</p><p>Hi sweetheart! Bring your fake passport and a bathing suit. Address =
attached. love, Ann</p><h3 id=4-what-two-items-did-ann-tell-her-secret-lover-to-bring>4. What two items did Ann tell her secret lover to bring?</h3><p>從上提的封包內容提到 fake passport 和 bathing suit</p><h3 id=5-what-is-the-name-of-the-attachment-ann-sent-to-her-secret-lover>5. What is the NAME of the attachment Ann sent to her secret lover?</h3><p>從第 3 題封包可以看見 secretrendezvous.docx 的附件。</p><p><img src=https://i.imgur.com/dvYirrm.png alt></p><h3 id=6-what-is-the-md5sum-of-the-attachment-ann-sent-to-her-secret-lover>6. What is the MD5sum of the attachment Ann sent to her secret lover?</h3><p>從上題已經知道傳輸檔案了，並從該封包中可發現 <code>Content-Transfer-Encoding: base64</code>，該檔案會使用 base64 編碼做處理。</p><p>以下是檔案做 base64 的編碼</p><pre><code class="language-shell=" data-lang="shell=">UEsDBBQABgAIA...
...
AA0ADQBEAwAA9CYDAAAA
</code></pre><p>將編碼的檔案還原，將第5題的封包使用 Raw 並載下，將檔案的編碼前後雜訊給刪除，留下該檔案的編碼。</p><pre><code class="language-shell=" data-lang="shell="># 還原
$ openssl base64 -d &lt; temp &gt; secretrendezvous.docx
$ md5sum secretrendezvous.docx
9e423e11db88f01bbff81172839e1923  secretrendezvous.docx
</code></pre><p><code>9e423e11db88f01bbff81172839e1923</code> 為該檔案 <code>MD5sum</code></p><h3 id=7-in-what-city-and-country-is-their-rendez-vous-point>7. In what CITY and COUNTRY is their rendez-vous point?</h3><p>上題將檔案還原，其內容為 <code>Meet me at the fountain near the rendezvous point. Address below. I’m bringing all the cash.</code></p><p>並附上一個地圖，該地圖顯示的名稱就是答案 <code>Playa del Carmen</code>。</p><h3 id=8-what-is-the-md5sum-of-the-image-embedded-in-the-document>8. What is the MD5sum of the image embedded in the document?</h3><p>使用 <code>unzip</code> 將 word 裡的內容解析。</p><pre><code class="language-shell=" data-lang="shell=">$ unzip secretrendezvous.docx
Archive:  secretrendezvous.docx
  inflating: [Content_Types].xml
  inflating: _rels/.rels
  inflating: word/_rels/document.xml.rels
  inflating: word/document.xml
 extracting: word/media/image1.png
  inflating: word/theme/theme1.xml
  inflating: word/settings.xml
  inflating: word/webSettings.xml
  inflating: word/styles.xml
  inflating: docProps/core.xml
  inflating: word/numbering.xml
  inflating: word/fontTable.xml
  inflating: docProps/app.xml
  
$ md5sum word/media/image1.png
aadeace50997b1ba24b09ac2ef1940b7  word/media/image1.png
</code></pre><p><code>aadeace50997b1ba24b09ac2ef1940b7</code> 為答案</p><h2 id=參考>參考</h2><ul><li><a href=https://www.wireshark.org/docs/dfref/s/smtp.html>SMTP filter</a></li><li><a href=https://blog.mailtrap.io/smtp-commands-and-responses/#DATA>SMTP use</a></li><li><a href=https://www.opencli.com/linux/linux-get-docx-images>linux 取 word 圖片</a></li></ul></div><div class="d-flex flex-row justify-content-around"><h3 class="mb-1 mt-1 text-left mr-4"><a href=/blog/2020-05-17-ann-wireshark/ title="wireshark analysis Ann’s Bad AIM"><i class="nav-menu fas fa-chevron-circle-left"></i></a></h3><h3 class="mb-1 mt-1 text-left ml-4"><a href=/blog/2020-06-12-es/ title="Elasticsearch 筆記"><i class="nav-menu fas fa-chevron-circle-right"></i></a></h3></div></main><footer class="mt-2 mb-4 text-center"><span class=markdownify>short copyright message</span>
<span>&#183;
<i><a href=https://github.com/darshanbaral/aafu>aafu</a></i>
by
<a href=https://www.darshanbaral.com/>darshan</a></span></footer></body></html>