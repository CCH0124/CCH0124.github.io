<!doctype html><html lang=en-us style=max-width:1000px;margin:auto><head><title>Kevin Blog</title><meta name=theme-color content><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta name=description content="Kevin learning"><meta name=author content="Kevin Chen"><meta name=generator content="aafu theme by Darshan in Hugo 0.83.0"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.2/css/all.css integrity=sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu crossorigin=anonymous><link rel=stylesheet href=https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Didact+Gothic%7CRoboto:400%7CRoboto+Mono"><link rel=stylesheet href=/css/aafu_pinkish.css><link rel=stylesheet href=/css/aafu.css><script>var themeColor=document.querySelector("meta[name=theme-color]");window.onload=()=>{themeColor.content=getComputedStyle(document.body)["background-color"];let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")},window.onresize=()=>{let a=document.querySelector(".accordion.active");a&&(a.nextElementSibling.style.maxHeight=a.nextElementSibling.scrollHeight+"px")}</script></head><body class=container><main style="min-height:calc(100vh - 60px)"><div class="d-flex flex-row row p-2"><h3 class="main-menu mr-3"><a href=https://cch0124.github.io/>Home</a></h3><h3 class="main-menu mr-3"><a href=/blog>Blog</a></h3><h3 class="main-menu mr-3"><a href=/project>Project</a></h3><h3 class="main-menu mr-3"><a href=/life>Life</a></h3><h3 class="main-menu mr-3"><a href=/kubernetes>Kubernetes</a></h3><h3 class="main-menu mr-3"><a href=/code>Coding</a></h3></div><div class=mb-3><h1 class=top-h1 style=font-size:2.75em>wireshark analysis Ann AppleTV</h1><p class=mb-1>August 2, 2020</p><p>&mdash;</p></div><div class=content><h2 id=題目>題目</h2><p><a href=http://forensicscontest.com/2009/12/28/anns-appletv>題目和內容</a>，其中 Ann 的靜態 IP 是 192.168.1.10</p><ol><li>What is the MAC address of Ann’s AppleTV?</li><li>What User-Agent string did Ann’s AppleTV use in HTTP requests?</li><li>What were Ann’s first four search terms on the AppleTV (all incremental searches count)?</li><li>What was the title of the first movie Ann clicked on?</li><li>What was the full URL to the movie trailer (defined by “preview-url”)?</li><li>What was the title of the second movie Ann clicked on?</li><li>What was the price to buy it (defined by “price-display”)?</li><li>What was the last full term Ann searched for?</li></ol><h3 id=1-what-is-the-mac-address-of-anns-appletv->1. What is the MAC address of Ann’s AppleTV ?</h3><p>將 <code>View -> Name Resolution -> Resolve Physical Address</code> 打勾，其 wireshark 能夠將 MAC 做解析，從第二層鏈結層可以看到 MAC 地址對應的廠商，00:25:00 對應的是 Apple 廠商。</p><p><img src=https://i.imgur.com/8fYyeD4.png alt></p><p><code>00:25:00:fe:07:c4</code></p><h3 id=2-what-user-agent-string-did-anns-appletv-use-in-http-requests>2. What User-Agent string did Ann’s AppleTV use in HTTP requests?</h3><p>使用 <code>http.user_agent</code> 過濾封包，再點選一個封包查看 HTTP 協定裡的協定，即可看到表頭。
<code>AppleTV/2.4</code></p><h3 id=what-were-anns-first-four-search-terms-on-the-appletv-all-incremental-searches-count>What were Ann’s first four search terms on the AppleTV (all incremental searches count)?</h3><p>使用 <code>http.request.uri.query</code> 關鍵字過濾封包，並查看 <code>q</code> 關鍵字，可以得知在 AppleTV 上搜尋的第一個四個字的搜索詞為 <code>hack</code>。通常 <code>q</code> 關鍵都用於搜索相關。</p><p><img src=https://i.imgur.com/c0hIIo6.png alt></p><h3 id=what-was-the-title-of-the-first-movie-ann-clicked-on>What was the title of the first movie Ann clicked on?</h3><p>接續上面的過濾結果其第 307 個封包顯示出請求 <code>viewMovie?id=333441649&s=143441</code>，其 <code>id</code> 是點擊看的電影，而 <code>s</code> 猜測是和 <code>X-Apple-Store-Front</code> 表頭有關其表是國家等資訊。但過濾的封包有點多，這邊使用 <code>http.request.uri contains viewMovie</code> 作為過濾的封包的條件，可以發現 Ann 應該是看了 2 部電影。</p><p>但是要如何知道它們電影名稱? 我們知道過濾後第 307 封包是請求封包，接著我們查看回應它的封包，該封包為第 312 個，其中它回應的是一個 XML，而從該 XML 可得知她看的為 Hackers。該 XML 包含了有關金額或者上映日期、可觀看年齡等資訊。</p><pre><code class="language-xml=" data-lang="xml="> ...
 &lt;key&gt;title&lt;/key&gt; 
       &lt;string&gt;Hackers&lt;/string&gt; 
       &lt;key&gt;store-version&lt;/key&gt; 
       &lt;string&gt;1.0&lt;/string&gt; 
...
</code></pre><h3 id=what-was-the-full-url-to-the-movie-trailer-defined-by-preview-url>What was the full URL to the movie trailer (defined by “preview-url”)?</h3><p>接著我們將 312 封包使用 <code>http stream</code> 方式來查看，並尋找 <code>preview-url</code> 相關資訊。</p><pre><code class="language-xml=" data-lang="xml=">...
&lt;key&gt;preview-url&lt;/key&gt;&lt;string&gt;http://a227.v.phobos.apple.com/us/r1000/008/Video/62/bd/1b/mzm.plqacyqb..640x278.h264lc.d2.p.m4v&lt;/string&gt;
...
</code></pre><h3 id=what-was-the-title-of-the-second-movie-ann-clicked-on>What was the title of the second movie Ann clicked on?</h3><p>使用和找第一個看電影的方式去完成。使用 <code>http.request.uri contains viewMovie</code> 關鍵字過濾，第 1181 個請求封包，接著我們找它的回應封包為第 1186 個封包。同樣使用 <code>http stream</code> 方式來查看，該第二個點擊的電影為 <code>Sneakers</code>。</p><h3 id=what-was-the-price-to-buy-it-defined-by-price-display>What was the price to buy it (defined by “price-display”)?</h3><p>使用上一個 XML 查找。
SDVOD 為 2.99
STDQ 為 9.99</p><h3 id=what-was-the-last-full-term-ann-searched-for>What was the last full term Ann searched for?</h3><p>最後一次搜尋我們使用 <code>http.request.uri.query.parameter contains q && http.request.uri contains "/WebObjects/MZSearch.woa/wa/incrementalSearch"</code> 過濾</p><p><img src=https://i.imgur.com/x22uZP0.png alt></p><p>這一個為最後一次搜尋。</p></div><div class="d-flex flex-row justify-content-around"><h3 class="mb-1 mt-1 text-left mr-4"><a href=/blog/2020-06-12-es/ title="Elasticsearch 筆記"><i class="nav-menu fas fa-chevron-circle-left"></i></a></h3><h3 class="mb-1 mt-1 text-left ml-4"><a href=/blog/2020-08-17-know-data/ title="30 天學習歷程-day01"><i class="nav-menu fas fa-chevron-circle-right"></i></a></h3></div></main><footer class="mt-2 mb-4 text-center"><span class=markdownify>short copyright message</span>
<span>&#183;
<i><a href=https://github.com/darshanbaral/aafu>aafu</a></i>
by
<a href=https://www.darshanbaral.com/>darshan</a></span></footer></body></html>